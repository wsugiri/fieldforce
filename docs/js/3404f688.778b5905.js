(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["3404f688"],{1935:function(t,e,a){},"2ca8":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-layout",{staticClass:"page-eskalasi"},[a("q-layout-header",[a("q-toolbar",{attrs:{color:"primary"}},[a("q-toolbar-title",[t._v("Eskalasi")]),a("q-btn",{attrs:{flat:""},on:{click:function(e){t.save()}}},[t._v("Save")]),a("q-btn",{attrs:{flat:""},on:{click:function(e){t.cancel()}}},[t._v("Cancel")])],1)],1),a("q-page-container",[a("q-page",[a("v-store-profile",{attrs:{store:t.store}}),a("div",{staticClass:"card-eskalasi"},[a("q-card",[a("q-card-main",[a("q-field",{attrs:{label:"Kategori Eskalasi"}},[a("q-option-group",{attrs:{type:"radio",color:"secondary",options:[{label:"Toko Libur / Tutup Sementara",value:"1"},{label:"Toko Tutup Permanen",value:"2"},{label:"Toko Pindah",value:"3"},{label:"Toko dalam Renovasi",value:"4"},{label:"Lain-lain",value:"5"}]},model:{value:t.model.data.escal_categ,callback:function(e){t.$set(t.model.data,"escal_categ",e)},expression:"model.data.escal_categ"}})],1),a("q-field",{attrs:{label:"Keterangan"}},[a("q-input",{attrs:{type:"textarea"},model:{value:t.model.data.escal_notes,callback:function(e){t.$set(t.model.data,"escal_notes",e)},expression:"model.data.escal_notes"}})],1)],1)],1),a("v-take-picture",{staticClass:"q-mt-sm",attrs:{images:t.images}})],1)],1)],1)],1)},r=[];s._withStripped=!0;a("ac6a"),a("96cf");var i=a("c973"),n=a.n(i),o=(a("28a5"),a("f490")),c=(a("551c"),a("f9d8")),l=a("f1c2"),u={save:function(t,e){var a=t.state.store;return t.commit("eskalasi",e),c["a"].set(a.store_id,a),new Promise(function(){var a=n()(regeneratorRuntime.mark(function a(s,r){return regeneratorRuntime.wrap(function(a){while(1)switch(a.prev=a.next){case 0:try{e.data.isonline=navigator.onLine?1:0,l["a"].saveDraft(t,e),s(e)}catch(a){l["a"].saveDraft(t,e),r(a)}case 1:case"end":return a.stop()}},a,this)}));return function(t,e){return a.apply(this,arguments)}}())}},d=u,f=a("ad89"),h=a("3609"),m="http://fieldforce.seegolabs.com/static/no-image.png",p={components:{vStoreProfile:f["a"],vTakePicture:h["a"]},data:function(){return{store:{},images:[{id:1,src:m},{id:2,src:m}],model:{data:{}}}},beforeCreate:function(){var t=this.$q,e=this.$route,a=this.$router,s=e.params.id,r=t.localStorage.get.item(s);if(r&&r.visit){var i=r.visit.eskalasi;if(!i||!i.data){var n=o["a"].formatDate(new Date,"YYYY-MM-DD");i={day:n,activity:"escalation",key:"".concat(s,".esc.").concat(n.split("-")[2]).toLocaleUpperCase(),data:{store_id:s,start_date:(new Date).toISOString().substr(0,23)}},r.visit.eskalasi=i}this.$store.commit("store",r),this.$store.commit("eskalasi",i)}else a.push({name:"app.stores"})},created:function(){this.store=this.$store.state.store,this.model=this.$store.state.eskalasi,this.refresh()},methods:{refresh:function(){var t=n()(regeneratorRuntime.mark(function t(){var e,a,s,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:for(e=this.model,a=0;a<2;a+=1)s="".concat(e.key,".").concat(a+1),r=this.$q.localStorage.get.item(s),r&&(this.images[a].src=r);if(e.data.gps){t.next=8;break}return t.t0=JSON,t.next=6,oAuth.getCurrentPosition();case 6:t.t1=t.sent,e.data.gps=t.t0.stringify.call(t.t0,t.t1);case 8:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),save:function(){var t=n()(regeneratorRuntime.mark(function t(){var e,a,s,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.validate()){t.next=2;break}return t.abrupt("return");case 2:return e=this.$q,a=this.$store,s=this.$router,r=this.model,t.prev=3,e.loading.show(),t.next=7,d.save(a,r);case 7:e.loading.hide(),s.go(-1),t.next=15;break;case 11:t.prev=11,t.t0=t["catch"](3),e.loading.hide(),e.notify(t.t0.message);case 15:case"end":return t.stop()}},t,this,[[3,11]])}));return function(){return t.apply(this,arguments)}}(),validate:function(){var t=this,e=(this.store,this.model),a=[];if(e.data.escal_categ){if(e.data.escal_notes)return this.images.forEach(function(s){var r=s.id,i=s.src,n=i.length>100,o=i.indexOf("fieldforce.seegolabs.com/api/buckets")>0,c="".concat(e.key,".").concat(r);n||o?(a.push(i),i.length>100?t.$q.localStorage.set(c,i):t.$q.localStorage.remove(c)):t.$q.localStorage.remove(c)}),0!==a.length||(this.$q.notify("Silahkan masukkan minimal 1 foto"),!1);this.$q.notify("Silahkan isi keterangan eskalasi")}else this.$q.notify("Silahkan pilih kategori eskalasi")},cancel:function(){this.$router.go(-1)}}},v=p,g=(a("4ef4"),a("2877")),k=Object(g["a"])(v,s,r,!1,null,null,null);k.options.__file="eskalasi.vue";e["default"]=k.exports},"4ef4":function(t,e,a){"use strict";var s=a("1935"),r=a.n(s);r.a}}]);